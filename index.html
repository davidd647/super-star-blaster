<!--

	- Develop a complex staged game infrastructure
	- Make the spaceship globby?
	- Aspects of the game depend on web API
		- Like... NASA API (with Mars pics?)
	- Make it a SPA?
	- Use OAuth to share in a special way on soc med?

 -->

<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>super star blaster!</title>
	<style>
		#myCanvas{
			background: lightblue;
		}
		.key-up {
		    opacity: 0.5;
		}
	</style>
</head>
<body>
	<p>super star blaster!</p>


	<canvas id="myCanvas" width="640" height="480">
	</canvas>

	<div class="dev-tools">
		<ul id="log">
		    <li>List of keys:</li>
		</ul>
	</div>

	<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js'></script>
	<script>
		//configure graphics processing
			var c = document.getElementById("myCanvas");
			var ctx = c.getContext("2d");


		//set up stuff to be animated
			//arc variables
				var arcX = 100;
				var arcY = 50;
			//draw arc itself
				ctx.beginPath();
				ctx.arc(arcX,arcY,40,0,2*Math.PI);
				ctx.stroke();


		//keylogger visualization
			//main var for keylogger visualization
				var log = $('#log')[0], pressedKeys = [];
			//main var for keylogger interaction
				var keyIsDown = [];


			$(document.body).keydown(function (evt) {
			    //keylogger visualization
				    var li = pressedKeys[evt.keyCode];
				    if (!li) {
				        li = log.appendChild(document.createElement('li'));
				        pressedKeys[evt.keyCode] = li;
				    }
				    $(li).text('Down: ' + evt.keyCode);
				    $(li).removeClass('key-up');
				//keylogger interaction
					var tempKey = evt.keyCode;
					keyIsDown[tempKey] = true;
			});
			$(document.body).keyup(function (evt) {
				//keylogger visualization
				    var li = pressedKeys[evt.keyCode];
				    if (!li) {
				       li = log.appendChild(document.createElement('li'));
				    }
				    $(li).text('Up: ' + evt.keyCode);
				    $(li).addClass('key-up');
				//keylogger interaction
					var tempKey = evt.keyCode;
					keyIsDown[evt.keyCode] = false;
			});

		//the loop
			var period = 100; // ms
			var endTime = 1000000000;  // ms
			var counter = 0;
			var sleepyAlert = setInterval(function(){
				//react when keys are pressed
			    if (keyIsDown[65] === true){
			    	arcX--;
			    }
			    if (keyIsDown[68] === true){
			    	arcX++;
			    }
			    if (keyIsDown[87] === true){
			    	arcY--;
			    }
			    if (keyIsDown[83]){
			    	arcY++;
			    }
			    if(counter === endTime){
			       clearInterval(sleepyAlert);
			    }
			    console.log("Coordinates: "+arcX+" "+arcY);

			    ctx.arc(arcX,arcY,40,0,2*Math.PI);
			    ctx.stroke();

			    counter += period;
			}, period);
	</script>
</body>
</html>